<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSW TECH AMIGOS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a; /* Dark background for Vanta */
            overflow-x: hidden;
        }
        #vanta-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
        }
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .animate-fadeIn { animation: fadeIn 0.8s ease-in-out forwards; }
        @keyframes fadeOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.95); } }
        .animate-fadeOut { animation: fadeOut 0.5s ease-in-out forwards; }
        @keyframes popUp { from { opacity: 0; transform: translateY(20px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
        .animate-popUp { animation: popUp 0.6s cubic-bezier(0.165, 0.84, 0.44, 1) forwards; }
        
        .typed-cursor {
            color: #06b6d4;
            font-size: 2rem;
        }
        .section {
            padding: 6rem 2rem;
            position: relative;
            background-color: rgba(10, 10, 10, 0.5);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="text-white">

    <!-- Vanta.js Animated Background -->
    <div id="vanta-bg"></div>

    <!-- Header Section -->
    <header class="relative flex flex-col items-center justify-center min-h-screen p-4 text-center">
        <nav class="absolute top-0 right-0 p-6 z-10">
            <a href="#about" class="mx-2 text-lg font-semibold text-gray-300 hover:text-cyan-400 transition-colors">About</a>
            <a href="#contact" class="mx-2 text-lg font-semibold text-gray-300 hover:text-cyan-400 transition-colors">Contact</a>
            <button id="open-register-nav" class="mx-2 text-lg font-semibold text-gray-300 hover:text-cyan-400 transition-colors">Enter Bingo</button>
        </nav>
        
        <div class="text-center">
            <h1 class="text-5xl md:text-7xl lg:text-8xl font-bold font-orbitron text-cyan-400 tracking-widest leading-tight" style="text-shadow: 0 0 10px rgba(0, 255, 255, 0.7), 0 0 20px rgba(0, 255, 255, 0.5);">
                DSW <br> <span class="text-white">TECH AMIGOS</span>
            </h1>
            <p class="mt-4 text-xl md:text-2xl text-gray-300 min-h-[2rem]">
                <span id="typed-text"></span>
            </p>
        </div>

        <div class="mt-12">
            <button id="open-register-main" class="bg-cyan-500 hover:bg-cyan-400 text-gray-900 font-bold py-3 px-8 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-cyan-500/30 text-xl">
                Register for Event
            </button>
        </div>
    </header>

    <!-- About Us Section -->
    <section id="about" class="section">
        <div class="max-w-5xl mx-auto text-center">
            <h2 class="text-4xl font-bold font-orbitron text-cyan-400 mb-8">About DSW Tech Amigos</h2>
            <p class="text-lg text-gray-300 leading-relaxed max-w-3xl mx-auto">
                DSW Tech Amigos proudly presents the annual technical festival of our institution, a grand spectacle of technology and innovation. It is a premier platform for the brightest minds to converge, compete, and showcase their extraordinary talents. We are driven by the belief in technology's power to reshape our world, and we are fiercely committed to creating an environment where students can learn, evolve, and pioneer the future.
            </p>
        </div>
    </section>

    <!-- Contact and Location Section -->
    <section id="contact" class="section">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold font-orbitron text-cyan-400 mb-12 text-center">Get In Touch</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <!-- Contact Info -->
                <div class="text-center md:text-left">
                    <div class="mb-8">
                        <h3 class="text-2xl font-bold text-cyan-400 mb-2">Location</h3>
                        <p class="text-gray-300 text-lg">
                            Chandigarh Group of Colleges (CGC) - Landran,<br>
                            Landran, Kharar, Greater Mohali, Punjab 140307
                        </p>
                    </div>
                    <div class="mb-8">
                        <h3 class="text-2xl font-bold text-cyan-400 mb-2">Contact Us</h3>
                        <p class="text-gray-300 text-lg">
                            <a href="mailto:dsw@cgc.edu.in" class="hover:text-cyan-300 transition-colors">dsw@cgc.edu.in</a>
                        </p>
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold text-cyan-400 mb-4">Follow Us</h3>
                        <div class="flex justify-center md:justify-start space-x-6">
                            <a href="https://www.instagram.com/dsw.cgc/" target="_blank" class="text-gray-400 hover:text-cyan-400 transition-colors text-3xl"><i class="fab fa-instagram"></i></a>
                            <a href="#" target="_blank" class="text-gray-400 hover:text-cyan-400 transition-colors text-3xl"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#" target="_blank" class="text-gray-400 hover:text-cyan-400 transition-colors text-3xl"><i class="fab fa-twitter"></i></a>
                        </div>
                    </div>
                </div>
                <!-- Map -->
                <div>
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3432.434863991242!2d76.6622867755791!3d30.6500271746241!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x390fef154b91a85b%3A0x4d8b9df97e986631!2sChandigarh%20Group%20of%20Colleges%20(CGC)%20-%20Landran!5e0!3m2!1sen!2sin!4v1722713759905!5m2!1sen!2sin" width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" class="rounded-lg shadow-2xl shadow-cyan-500/10"></iframe>
                </div>
            </div>
        </div>
    </section>

    <!-- Registration Pop-up Modal -->
    <div id="register-popup" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden" style="backdrop-filter: blur(8px);">
        <div id="popup-content" class="bg-gray-800 border border-cyan-500/50 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center relative">
            <button id="close-popup" class="absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
            <h2 class="text-2xl md:text-3xl font-bold font-orbitron text-cyan-400 mb-6">Event Registration</h2>
            
            <form id="registration-form">
                <div class="space-y-4 text-left">
                    <input type="text" name="Name" placeholder="Full Name" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500" required>
                    <input type="email" name="Email" placeholder="Email ID" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500" required>
                    <input type="text" name="Course" placeholder="Course (e.g., B.Tech CSE)" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500" required>
                    <input type="text" name="Semester" placeholder="Semester" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500" required>
                    <input type="text" name="RollNo" placeholder="Roll No." class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500" required>
                </div>
                <button type="submit" class="w-full mt-8 bg-fuchsia-600 hover:bg-fuchsia-500 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-fuchsia-500/20">
                    Enter Bingo
                </button>
            </form>
            <p id="success-message" class="mt-4 text-green-400 hidden">Registration successful! Redirecting to Bingo...</p>
            <p id="error-message" class="mt-4 text-red-400 hidden"></p>
        </div>
    </div>
    
    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta/dist/vanta.net.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

    <script>
        // --- Element References ---
        const registerPopup = document.getElementById('register-popup');
        const popupContent = document.getElementById('popup-content');
        const closePopupButton = document.getElementById('close-popup');
        const openRegisterNav = document.getElementById('open-register-nav');
        const openRegisterMain = document.getElementById('open-register-main');
        const registrationForm = document.getElementById('registration-form');
        const successMessage = document.getElementById('success-message');
        const errorMessage = document.getElementById('error-message');

        const sheetBestUrl = "https://api.sheetbest.com/sheets/6980474d-e006-4f19-bf77-9a702862b3ca";

        // --- Pop-up Modal Logic ---
        function showPopup() {
            errorMessage.classList.add('hidden'); // Hide error on open
            registerPopup.classList.remove('hidden');
            registerPopup.classList.add('animate-fadeIn');
            popupContent.classList.add('animate-popUp');
        }

        function hidePopup() {
            registerPopup.classList.add('animate-fadeOut');
            setTimeout(() => {
                registerPopup.classList.add('hidden');
                registerPopup.classList.remove('animate-fadeOut');
                successMessage.classList.add('hidden');
                registrationForm.style.display = 'block';
                registrationForm.reset();
            }, 500);
        }

        openRegisterNav.addEventListener('click', showPopup);
        openRegisterMain.addEventListener('click', showPopup);
        closePopupButton.addEventListener('click', hidePopup);
        
        // --- Registration Form Logic ---
        registrationForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const submitButton = registrationForm.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = 'Verifying...';
            errorMessage.classList.add('hidden');

            const formData = new FormData(registrationForm);
            const data = Object.fromEntries(formData.entries());
            const userEmail = data.Email.trim().toLowerCase();
            const userRollNo = data.RollNo.trim().toLowerCase();

            try {
                // 1. Fetch existing data to check for duplicates
                const responseGet = await fetch(sheetBestUrl);
                if (!responseGet.ok) {
                    throw new Error("Could not check existing registrations.");
                }
                const existingData = await responseGet.json();

                // 2. Check for duplicate email or roll number
                const isDuplicate = existingData.some(entry => 
                    (entry.Email && entry.Email.trim().toLowerCase() === userEmail) || 
                    (entry.RollNo && entry.RollNo.trim().toLowerCase() === userRollNo)
                );

                if (isDuplicate) {
                    errorMessage.textContent = "This Email or Roll No. is already registered.";
                    errorMessage.classList.remove('hidden');
                    return; // Stop the submission
                }
                
                // 3. If no duplicate, proceed to submit new data
                submitButton.innerHTML = 'Submitting...';
                const responsePost = await fetch(sheetBestUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify([data]),
                });

                if (responsePost.ok) {
                    registrationForm.style.display = 'none';
                    successMessage.classList.remove('hidden');
                    
                    // **FIX:** Redirect to the Bingo website after a short delay
                    setTimeout(() => {
                        window.location.href = 'https://xpedition-tech-bingo.vercel.app/';
                    }, 1500); // 1.5-second delay to show success message

                } else {
                    const errorData = await responsePost.json();
                    throw new Error(errorData.detail || "An unknown error occurred during submission.");
                }

            } catch (error) {
                console.error("Submission Process Error:", error);
                errorMessage.textContent = error.message.includes("denied") 
                    ? "Submission Failed: Check Google Sheet permissions." 
                    : "An error occurred. Please try again.";
                errorMessage.classList.remove('hidden');
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;
            }
        });

        // --- Vanta.js and Typed.js Animations ---
        document.addEventListener('DOMContentLoaded', () => {
            VANTA.NET({
                el: "#vanta-bg",
                mouseControls: true,
                touchControls: true,
                gyroControls: false,
                minHeight: 200.00,
                minWidth: 200.00,
                scale: 1.00,
                scaleMobile: 1.00,
                color: 0x00fff7, // cyan
                backgroundColor: 0x0a0a0a,
                points: 12.00,
                maxDistance: 25.00,
                spacing: 18.00
            });

            new Typed("#typed-text", {
                strings: ["Innovate. Create. Inspire.", "The Future is Now.", "Welcome to the Hub of Technology."],
                typeSpeed: 50,
                backSpeed: 25,
                backDelay: 2000,
                loop: true
            });
        });
    </script>
</body>
</html>
